#!/bin/sh
set -e

version=5.0.2
hash=0c49864ea7ab2be8b95c4495e5825b0e48b8611e1761c1b22b86a3f4bf9201bf
file=Oracle_VM_VirtualBox_Extension_Pack-$version.vbox-extpack

error ()
{
	echo "Hash mismatch $file"
	exit 1
}

# Source debconf library.
. /usr/share/debconf/confmodule

if [ "$1" = "configure" ] ; then
        db_get virtualbox-ext-pack/license
        if [ "$RET" = true ] ; then
		cd /usr/share/virtualbox-ext-pack
		echo "virtualbox-ext-pack: downloading: http://download.virtualbox.org/virtualbox/$version/$file"
		wget -q -N http://download.virtualbox.org/virtualbox/$version/$file
		echo "$hash  $file" | sha256sum -c > /dev/null 2>&1 || error
		vboxmanage extpack install --replace $file
	else
		exit 1
	fi
fi

#DEBHELPER#
